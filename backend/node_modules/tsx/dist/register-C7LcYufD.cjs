"use strict";var J=Object.defineProperty;var o=(e,s)=>J(e,"name",{value:s,configurable:!0});var I=require("./get-pipe-path-BoR10qr8.cjs"),d=require("node:module"),p=require("node:path"),b=require("node:url"),j=require("get-tsconfig"),W=require("node:fs"),S=require("./index-CoHsQGpm.cjs"),O=require("./client-D6NvIMSC.cjs");const y=Object.create(null);y[".js"]=[".ts",".tsx",".js",".jsx"],y[".jsx"]=[".tsx",".ts",".jsx",".js"],y[".cjs"]=[".cts"],y[".mjs"]=[".mts"];const w=o(e=>{const[s,t]=e.split("?"),a=p.extname(s),i=y[a];if(i){const f=s.slice(0,-a.length);return i.map(r=>f+r+(t?`?${t}`:""))}},"resolveTsPath"),k=o(e=>{const s=e.indexOf(":");if(s!==-1)return e.slice(0,s)},"getScheme"),$=o(e=>e[0]==="."&&(e[1]==="/"||e[1]==="."||e[2]==="/"),"isRelativePath"),Q=o(e=>$(e)||p.isAbsolute(e),"isUnixPath"),B=o(e=>{if(Q(e))return!0;const s=k(e);return s&&s!=="node"},"requestAcceptsQuery"),L="file://",A=/\.([cm]?ts|[tj]sx)($|\?)/,z=/\.json($|\?)/,G=/\/(?:$|\?)/,H=/^(?:@[^/]+\/)?[^/]+$/;exports.fileMatcher=void 0,exports.tsconfigPathsMatcher=void 0,exports.allowJs=!1;const F=o(e=>{let s=null;if(e){const t=p.resolve(e);s={path:t,config:j.parseTsconfig(t)}}else{try{s=j.getTsconfig()}catch{}if(!s)return}exports.fileMatcher=j.createFilesMatcher(s),exports.tsconfigPathsMatcher=j.createPathsMatcher(s),exports.allowJs=s?.config.compilerOptions?.allowJs??!1},"loadTsconfig"),T=o(e=>Array.from(e).length>0?`?${e.toString()}`:"","urlSearchParamsStringify"),X=`${p.sep}node_modules${p.sep}`,N=o(e=>{if(!e.startsWith("data:text/javascript,"))return e;const s=e.indexOf("?");if(s===-1)return e;const t=new URLSearchParams(e.slice(s+1));let a=t.get("filePath");if(a){const i=t.get("namespace");i&&(a+=`?namespace=${encodeURIComponent(i)}`),d._cache[a]=d._cache[e],delete d._cache[e],e=a}return e},"interopCjsExports"),E=o((e,s,t)=>{if(!(t?.filename&&A.test(t.filename))&&!exports.allowJs)return;const a=w(s);if(a)for(const i of a)try{return e(i)}catch(f){const{code:r}=f;if(r!=="MODULE_NOT_FOUND"&&r!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw f}},"resolveTsFilename"),K=[".ts",".tsx",".jsx"],_=o((e,s)=>{for(const t of K)try{return e(s+t)}catch{}},"tryExtensions"),V=o((e,s)=>(t,a,i,f)=>{const r=o(c=>e(c,a,i,f),"resolve");t=N(t);const[m,g]=t.split("?"),u=new URLSearchParams(g);if(a?.filename){const n=new URLSearchParams(a.filename.split("?")[1]).get("namespace");n&&u.append("namespace",n)}if((u.get("namespace")??void 0)!==s)return r(t);const l=T(u);if(t=m,t.startsWith(L)&&(t=b.fileURLToPath(t)),exports.tsconfigPathsMatcher&&!$(t)&&!a?.filename?.includes(X)){const c=exports.tsconfigPathsMatcher(t);for(const n of c){const h=E(r,n,a);if(h)return h+l;try{return r(n)+l}catch{const x=_(r,n)||_(r,`${t}${p.sep}index`);if(x)return x+l}}}const P=E(r,t,a);if(P)return P+l;try{const c=r(t);return c+(p.isAbsolute(c)?l:"")}catch(c){const n=c;if(n.code==="MODULE_NOT_FOUND"&&typeof n.path=="string"&&n.path.endsWith("package.json")){const x=n.message.match(/^Cannot find module '([^']+)'$/);if(x){const M=x[1],v=E(r,M,a);if(v)return v+l}const U=n.message.match(/^Cannot find module '([^']+)'. Please verify that the package.json has a valid "main" entry$/);if(U){const M=U[1],v=E(r,M,a);if(v)return v+l}}const h=_(r,t)||_(r,`${t}${p.sep}index`);if(h)return h+l;throw n}},"createResolveFilename"),Y=`
//# sourceMappingURL=data:application/json;base64,`,C=o(()=>process.sourceMapsEnabled??!0,"shouldApplySourceMap"),R=o(({code:e,map:s})=>e+Y+Buffer.from(JSON.stringify(s),"utf8").toString("base64"),"inlineSourceMap"),Z=[".cts",".mts",".ts",".tsx",".jsx"],q=[".js",".cjs",".mjs"],ee=o((e,s)=>{const t=Object.assign(Object.create(null),e),a=t[".js"],i=o((f,r)=>{const[m,g]=r.split("?");if((new URLSearchParams(g).get("namespace")??void 0)!==s)return a(f,m);O.parent?.send&&O.parent.send({type:"dependency",path:m});const l=Z.some(n=>m.endsWith(n)),P=q.some(n=>m.endsWith(n));if(!l&&!P)return a(f,m);let c=W.readFileSync(m,"utf8");if(m.endsWith(".cjs")){const n=S.transformDynamicImport(r,c);n&&(c=C()?R(n):n.code)}else if(l||S.isESM(c)){const n=S.transformSync(c,r,{tsconfigRaw:exports.fileMatcher?.(m)});c=C()?R(n):n.code}f._compile(c,m)},"transformer");return t[".js"]=i,[".ts",".tsx",".jsx",".mjs"].forEach(f=>{Object.defineProperty(t,f,{value:i,enumerable:!1})}),t},"createExtensions"),D=o((e,s)=>{if(!s)throw new Error("The current file path (__filename or import.meta.url) must be provided in the second argument of tsx.require()");return(typeof s=="string"&&s.startsWith("file://")||s instanceof URL)&&(s=b.fileURLToPath(s)),p.resolve(p.dirname(s),e)},"resolveContext"),se=o(e=>{const{sourceMapsEnabled:s}=process,{_extensions:t,_resolveFilename:a}=d;F(process.env.TSX_TSCONFIG_PATH),process.setSourceMapsEnabled(!0);const i=V(a,e?.namespace);d._resolveFilename=i;const f=ee(d._extensions,e?.namespace);d._extensions=f;const r=o(()=>{s===!1&&process.setSourceMapsEnabled(!1),d._extensions=t,d._resolveFilename=a},"unregister");if(e?.namespace){const m=o((u,l)=>{const P=D(u,l),[c,n]=P.split("?"),h=new URLSearchParams(n);return e.namespace&&h.set("namespace",e.namespace),I.require(c+T(h))},"scopedRequire");r.require=m;const g=o((u,l,P)=>{const c=D(u,l),[n,h]=c.split("?"),x=new URLSearchParams(h);return e.namespace&&x.set("namespace",e.namespace),i(n+T(x),module,!1,P)},"scopedResolve");r.resolve=g,r.unregister=r}return r},"register");exports.fileUrlPrefix=L,exports.inlineSourceMap=R,exports.interopCjsExports=N,exports.isBarePackageName=H,exports.isDirectoryPattern=G,exports.isJsonPattern=z,exports.loadTsconfig=F,exports.register=se,exports.requestAcceptsQuery=B,exports.resolveTsPath=w,exports.tsExtensionsPattern=A;
